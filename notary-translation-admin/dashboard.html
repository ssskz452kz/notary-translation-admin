<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>订单管理 - 公证翻译管理后台</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 顶部导航栏 -->
    <nav class="navbar">
        <div class="navbar-brand">
            <h2>公证翻译管理后台</h2>
        </div>
        <div class="navbar-menu">
            <a href="dashboard.html" class="nav-link active">订单管理</a>
            <a href="services.html" class="nav-link">服务类型</a>
            <a href="statistics.html" class="nav-link">数据统计</a>
            <a href="settings.html" class="nav-link">系统设置</a>
            <button class="btn btn-outline" onclick="logout()">退出登录</button>
        </div>
    </nav>

    <div class="container">
        <!-- 统计卡片 -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon pending">📋</div>
                <div class="stat-info">
                    <h3 id="pendingCount">-</h3>
                    <p>待处理订单</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon processing">⚙️</div>
                <div class="stat-info">
                    <h3 id="processingCount">-</h3>
                    <p>处理中订单</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon completed">✅</div>
                <div class="stat-info">
                    <h3 id="completedCount">-</h3>
                    <p>已完成订单</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon revenue">💰</div>
                <div class="stat-info">
                    <h3 id="todayRevenue">-</h3>
                    <p>今日收入</p>
                </div>
            </div>
        </div>

        <!-- 筛选和搜索 -->
        <div class="filter-bar">
            <div class="filter-group">
                <label>订单状态：</label>
                <select id="statusFilter" class="filter-select">
                    <option value="all">全部</option>
                    <option value="pending">待处理</option>
                    <option value="processing">处理中</option>
                    <option value="completed">已完成</option>
                    <option value="cancelled">已取消</option>
                </select>
            </div>
            <div class="filter-group">
                <label>服务类型：</label>
                <select id="serviceFilter" class="filter-select">
                    <option value="all">全部</option>
                    <option value="ID_CARD">身份证/护照</option>
                    <option value="BIRTH_MARRIAGE">出生证/结婚证</option>
                    <option value="EDUCATION">成绩单/毕业证</option>
                    <option value="CRIMINAL_RECORD">无犯罪证明</option>
                    <option value="OTHER">其他</option>
                    <option value="VISA">签证邀请函</option>
                </select>
            </div>
            <div class="filter-group">
                <label>日期范围：</label>
                <input type="date" id="dateFrom" class="filter-input">
                <span>至</span>
                <input type="date" id="dateTo" class="filter-input">
            </div>
            <div class="search-group">
                <input type="text" id="searchInput" class="search-input" placeholder="搜索订单号、客户姓名...">
                <button class="btn btn-primary" onclick="searchOrders()">搜索</button>
            </div>
        </div>

        <!-- 订单列表 -->
        <div class="orders-table-container">
            <table class="orders-table">
                <thead>
                    <tr>
                        <th>订单号</th>
                        <th>客户信息</th>
                        <th>服务类型</th>
                        <th>订单金额</th>
                        <th>下单时间</th>
                        <th>状态</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody id="ordersTableBody">
                    <!-- 订单数据将通过 JavaScript 动态加载 -->
                </tbody>
            </table>
        </div>

        <!-- 分页 -->
        <div class="pagination">
            <button class="btn btn-outline" onclick="prevPage()">上一页</button>
            <span class="page-info">第 <span id="currentPage">1</span> 页，共 <span id="totalPages">0</span> 页</span>
            <button class="btn btn-outline" onclick="nextPage()">下一页</button>
        </div>
    </div>

    <!-- 订单详情模态框 -->
    <div id="orderDetailModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>订单详情</h2>
                <button class="modal-close" onclick="closeOrderDetail()">&times;</button>
            </div>
            <div class="modal-body" id="orderDetailContent">
                <!-- 订单详情内容将通过 JavaScript 动态加载 -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeOrderDetail()">关闭</button>
            </div>
        </div>
    </div>

    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        // 确保 supabase 对象可用
        if (typeof supabase === 'undefined') {
            console.error('Supabase JS 库未加载！');
        }
    </script>
    <script src="config.js"></script>
    <script>
        // 验证配置
        if (typeof SUPABASE_CONFIG === 'undefined') {
            console.error('SUPABASE_CONFIG 未定义！请检查 config.js');
        } else {
            console.log('Supabase 配置已加载:', SUPABASE_CONFIG.url ? 'URL 已配置' : 'URL 未配置');
        }
    </script>
    <script src="app.js"></script>
    <script src="dashboard.js"></script>
</body>
</html>

